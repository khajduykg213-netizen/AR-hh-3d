<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Trải Net Hình Lập Phương – Chuẩn Toán</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/examples/js/controls/OrbitControls.js"></script>
<script src="https://cdn.jsdelivr.net/npm/gsap@3.12.2/dist/gsap.min.js"></script>
<style>
body{margin:0;overflow:hidden;font-family:Arial}
#ui{
 position:fixed;top:10px;left:10px;
 background:#fff;padding:10px;border-radius:10px
}
button{width:200px;margin-bottom:6px;padding:6px}
</style>
</head>

<body>
<div id="ui">
  <button onclick="createCube()">Hiển thị lập phương 3D</button>
  <button onclick="unfoldCube()">Trải Net (chuẩn Toán)</button>
</div>

<script>
/* ===== SCENE ===== */
const scene=new THREE.Scene();
scene.background=new THREE.Color(0xf2f2f2);

const camera=new THREE.PerspectiveCamera(60,innerWidth/innerHeight,0.1,100);
camera.position.set(3,3,4);

const renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
document.body.appendChild(renderer.domElement);

const controls=new THREE.OrbitControls(camera,renderer.domElement);

/* ===== LIGHT ===== */
scene.add(new THREE.AmbientLight(0xffffff,0.7));
const light=new THREE.DirectionalLight(0xffffff,0.8);
light.position.set(5,10,5);
scene.add(light);

/* ===== GLOBAL ===== */
let cubeGroup=null;
let faces=[];

/* ===== TẠO LẬP PHƯƠNG ===== */
function createCube(){
 clearAll();

 cubeGroup=new THREE.Group();
 const a=1;

 const materials=[
  0xff8a80, // trước
  0x80d8ff, // sau
  0xccff90, // phải
  0xffff8d, // trái
  0xb388ff, // trên
  0xffcc80  // dưới
 ];

 const positions=[
  [0,0,a/2],[0,0,-a/2],[a/2,0,0],[-a/2,0,0],[0,a/2,0],[0,-a/2,0]
 ];

 const rotations=[
  [0,0,0],[0,Math.PI,0],[0,-Math.PI/2,0],[0,Math.PI/2,0],[-Math.PI/2,0],[Math.PI/2,0]
 ];

 for(let i=0;i<6;i++){
  const geo=new THREE.PlaneGeometry(a,a);
  const mat=new THREE.MeshStandardMaterial({
    color:materials[i],
    side:THREE.DoubleSide
  });
  const face=new THREE.Mesh(geo,mat);
  face.position.set(...positions[i]);
  face.rotation.set(...rotations[i]);

  cubeGroup.add(face);
  faces.push(face);
 }

 scene.add(cubeGroup);
}

/* ===== TRẢI NET CHUẨN ===== */
function unfoldCube(){
 if(!cubeGroup) return;

 // Mặt đáy giữ nguyên
 const base=faces[5];

 // Các mặt xung quanh xoay quanh CẠNH
 gsap.to(faces[0].rotation,{x:-Math.PI/2,duration:1});
 gsap.to(faces[1].rotation,{x:Math.PI/2,duration:1});
 gsap.to(faces[2].rotation,{z:Math.PI/2,duration:1});
 gsap.to(faces[3].rotation,{z:-Math.PI/2,duration:1});

 // Mặt trên mở tiếp từ mặt trước
 gsap.to(faces[4].rotation,{x:-Math.PI,duration:1,delay:0.8});

 // Đưa toàn bộ xuống mặt phẳng
 gsap.to(cubeGroup.position,{y:-0.5,duration:1});
}

/* ===== CLEAR ===== */
function clearAll(){
 if(cubeGroup){
  scene.remove(cubeGroup);
  cubeGroup=null;
  faces=[];
 }
}

/* ===== RESIZE ===== */
window.onresize=()=>{
 camera.aspect=innerWidth/innerHeight;
 camera.updateProjectionMatrix();
 renderer.setSize(innerWidth,innerHeight);
}

/* ===== LOOP ===== */
function animate(){
 requestAnimationFrame(animate);
 controls.update();
 renderer.render(scene,camera);
}
animate();
</script>
</body>
</html>
